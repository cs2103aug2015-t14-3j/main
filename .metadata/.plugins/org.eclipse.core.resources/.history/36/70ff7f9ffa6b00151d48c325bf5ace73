import java.util.ArrayList;
import java.util.Collections;
import java.util.Map;

public class Displayer {
	
	private Storage storage;
	private ArrayList<Task> tasks;
	
	private final String DISPLAY_SUB = "subCommand";
	private final String DISPLAY_DATE = "date";
	
	private final String DISPLAY_HEADER = "Here is your schedule for %s:\n\nDescription         Start Date          End Date\n";
	private final String DISPLAY_FORMAT = "%d.%-18s%-20s%s\n";
	private final String FREE_DAY = "Looks like there is nothing in your schedule. Enjoy your day!!!\n";
	
	private final String INVALID_DISPLAY_SUB = "Invalid display subcommand specified\n";

	public Displayer(Storage storage) {
		this.storage = storage;
	}
	
	public String display(Map<String, String> parsedCommand) {
		String subCommand = parsedCommand.get(DISPLAY_SUB);
		String date = parsedCommand.get(DISPLAY_DATE);

		tasks = storage.display();
		
		if (subCommand == null) {
			//Display All
		} else {
			switch (subCommand) {
			case "on":
//				tasks = 
				break;
			case "from":
//				tasks = 
				break;
			case "after":
//				tasks = 
				break;
			case "due":
//				tasks = 
				break;
			case "incomplete":
//				tasks = 
				break;
			case "floating":
//				tasks = 
				break;
			default:
				return INVALID_DISPLAY_SUB;
			}
		}
		
		String output;
		
		if (tasks.size() == 0) {
			output = FREE_DAY;
			return output;
		}
		
		Collections.sort(tasks, new TaskSorter());
		
		output = String.format(DISPLAY_HEADER, "today");
		int index = 1;
		
		int i = 0;
		
		for (i = 0; i < tasks.size(); ++i) {
			Task task = tasks.get(i);
			
			String description = task.getDescription();
			String start = task.getStartDateTimeInString();
			String end = task.getEndDateTimeInString();
			
			output += String.format(DISPLAY_FORMAT, index, description, start, end);			
			++index;
		}
		
		output += "\n";
		return output;

		
//		return "command: display " + "sub: " + subCommand + " date: " + date + "\n";
	}
	
	public ArrayList<Task> getLastDisplay() {
		return tasks;
	}

}
