import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Scanner;

class UI {
	
	Scanner sc = new Scanner(System.in);
	private String output;
	private String input;
	private String userName;
	private String date;
	private String usernameFile = "UserName.txt";
	
	private Logic logic;
	private userNameAccess name;

	
	private final String REQUEST_NAME = "Please enter your Name: ";
	private final String REQUEST_COMMAND = "Command: ";
	private final String WELCOME_MESSAGE1 = "Date: %s\nTime: %s\n--------------------\n";
	private final String WELCOME_MESSAGE2 = "Welcome back, %s!\n";
	
	public UI() {
		logic = new TBLogic();
		name = new userNameAccess(usernameFile);
		output = new String();
		userName = name.getUserName();
		
		welcomeUser();
		
		String userName = logic.getUserName();
		if (userName == null) {
			requestUserName();
		}
		
		output = logic.welcomeMessage2();
		display(output);
		
		output = logic.toDoToday();
		display(output);
	}
	
	private void welcomeUser() {
		String time;
		getDateTime(date, time);
		
		output = String.format(WELCOME_MESSAGE1, date, time);
		return output;
	}
	
	private void getDateTime(String date, String time) {
		Date dateTime = new Date();
		SimpleDateFormat dateFormat = new SimpleDateFormat("dd MMMM yyyy, EEEE");
		SimpleDateFormat timeFormat = new SimpleDateFormat("HH:mm:ss");
		
		date = dateFormat.format(dateTime);
		time = timeFormat.format(dateTime);
		
	}
	
	private void requestUserName() {
		output = REQUEST_NAME;
		display(output);
		userName = sc.nextLine();
		output = "\n";
		display(output);
		logic.setUserName(userName);
	}
	
	public void run() {
		while (true) {
			output = REQUEST_COMMAND;
			display(output);
			input = sc.nextLine();
			output = logic.executeCommand(input);
			display(output);
		}
	}
	
	private void display(String output) {
		System.out.print(output);
	}
}

